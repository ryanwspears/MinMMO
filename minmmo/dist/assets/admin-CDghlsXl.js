import{o as M,d as J,e as oe,f as U,n as S,g as w,Z as ge,h as B,i as Re,k as z,r as E,l as De,s as Me,j as e,C as ks,m as Ns,p as Es,q as Ts,b as Ae,t as ws}from"./registry-Dc2uCTAH.js";const $e=["self","ally","enemy","any"],Pe=["self","single","all","random","lowest","highest","condition"],qe=["hpPct","staPct","mpPct","atk","def","lv","hasStatus","tag","clazz"],Be=["damage","heal","resource","applyStatus","cleanseStatus","dispel","modifyStat","shield","taunt","flee","revive","summon","giveItem","removeItem","preventAction"],Fe=["flat","percent","formula"],Ve=["hp","sta","mp"],He=["atk","def","maxHp","maxSta","maxMp"],Ue=["ignore","renew","stackCount","stackMagnitude"],Ge=["merchant","trainer","questGiver","generic"],_s=["common","uncommon","rare","epic"],Ye=M({side:U($e,{errorMap:()=>({message:"Target side is required"})}),mode:U(Pe,{errorMap:()=>({message:"Target mode is required"})}),count:S().int().positive().optional(),ofWhat:U(qe).optional(),includeDead:oe().optional(),condition:J().optional()}).passthrough(),Os=M({sta:S().min(0).optional(),mp:S().min(0).optional(),cooldown:S().min(0).optional(),charges:S().min(0).optional(),item:M({id:w().min(1,"Item id is required"),qty:S().min(1,"Quantity must be at least 1")}).partial().superRefine((s,r)=>{const m=typeof s.id=="string"&&s.id.length>0,o=typeof s.qty=="number"&&Number.isFinite(s.qty);m!==o&&r.addIssue({code:ge.custom,message:"Item id and quantity are both required when using item costs"})}).optional()}).partial().passthrough(),Ls=M({kind:U(Be,{errorMap:()=>({message:"Effect kind is required"})}),valueType:U(Fe).optional(),amount:S().finite().optional(),percent:S().finite().optional(),formula:M({expr:w().min(1,"Formula expression is required")}).optional(),min:S().finite().optional(),max:S().finite().optional(),element:w().optional(),canMiss:oe().optional(),canCrit:oe().optional(),resource:U(Ve).optional(),stat:U(He).optional(),statusId:w().optional(),statusTurns:S().int().nonnegative().optional(),cleanseTags:B(w()).optional(),shieldId:w().optional(),selector:Ye.optional(),onlyIf:J().optional()}).passthrough().superRefine((s,r)=>{const m=s.formula&&typeof s.formula.expr=="string"&&s.formula.expr.length>0,o=typeof s.amount=="number"&&Number.isFinite(s.amount),v=typeof s.percent=="number"&&Number.isFinite(s.percent);!m&&!o&&!v&&r.addIssue({code:ge.custom,message:"Provide an amount, percent, or formula",path:["amount"]})}),We=M({id:w().min(1,"ID is required"),name:w().min(1,"Name is required"),desc:w().optional(),element:w().optional(),targeting:Ye,effects:B(Ls).min(1,"At least one effect is required"),costs:Os.optional(),canUse:J().optional(),aiWeight:S().optional(),type:Re("skill").optional()}).passthrough(),Rs=We.extend({type:Re("item").optional(),consumable:oe().optional()}).passthrough(),Ds=M({id:w().min(1,"ID is required"),name:w().min(1,"Name is required"),desc:w().optional(),icon:w().optional(),tags:B(w().min(1,"Tag is required")).optional(),maxStacks:S().int().positive().optional(),stackRule:U(Ue).optional(),durationTurns:S().int().nonnegative().optional(),modifiers:J().optional(),hooks:J().optional()}).passthrough(),Ms=M({id:w().min(1,"ID is required"),maxHp:S().finite(),maxSta:S().finite(),maxMp:S().finite(),atk:S().finite(),def:S().finite(),skills:B(w().min(1,"Skill id is required")).optional(),startItems:B(M({id:w().min(1,"Item id is required"),qty:S().int().nonnegative("Quantity must be >= 0")})).optional()}).passthrough(),Oe=M({maxHp:S().nonnegative("Max HP must be >= 0"),maxSta:S().nonnegative("Max STA must be >= 0"),maxMp:S().nonnegative("Max MP must be >= 0"),atk:S().nonnegative("Attack must be >= 0"),def:S().nonnegative("Defense must be >= 0")}).passthrough(),As=M({id:w().min(1,"ID is required"),name:w().min(1,"Name is required"),color:S().finite(),base:Oe,scale:Oe,skills:B(w().min(1,"Skill id is required")).optional(),items:B(M({id:w().min(1,"Item id is required"),qty:S().int().nonnegative("Qty must be >= 0")})).optional(),tags:B(w().min(1,"Tag is required")).optional(),ai:M({preferTags:B(w().min(1,"Tag is required")).optional(),avoidTags:B(w().min(1,"Tag is required")).optional()}).partial().optional()}).passthrough(),$s=M({id:w().min(1,"ID is required"),name:w().min(1,"Name is required"),kind:U(Ge,{errorMap:()=>({message:"Kind is required"})}),wander:M({speed:S().nonnegative("Speed must be >= 0").optional(),region:w().min(1,"Region is required").optional()}).partial().optional(),inventory:B(M({id:w().min(1,"Item id is required"),qty:S().int().nonnegative("Quantity must be >= 0"),price:S().int().nonnegative("Price must be >= 0").optional(),rarity:w().optional()}).passthrough()).optional(),trainer:M({clazz:w().optional(),teaches:B(w().min(1,"Skill id is required")).optional(),priceBySkill:z(S().nonnegative("Price must be >= 0")).optional()}).partial().optional(),dialogue:M({lines:B(w().min(1,"Dialogue line is required")).optional(),options:B(M({text:w().min(1,"Option text is required"),action:J().optional()}).passthrough()).optional()}).partial().optional(),respawnTurns:S().int().nonnegative().optional()}).passthrough(),Ps=M({BASE_HIT:S().finite(),BASE_CRIT:S().finite(),CRIT_MULT:S().finite(),DODGE_FLOOR:S().finite(),HIT_CEIL:S().finite(),ELEMENT_MATRIX:z(z(S().finite())).optional(),RESISTS_BY_TAG:z(S().finite()).optional(),FLEE_BASE:S().finite(),ECONOMY:M({buyMult:S().finite(),sellMult:S().finite(),restockTurns:S().finite(),priceByRarity:z(S().finite()).optional()}).passthrough(),XP_CURVE:M({base:S().finite(),growth:S().finite()}).passthrough(),GOLD_DROP:M({mean:S().finite(),variance:S().finite()}).passthrough(),LOOT_ROLLS:S().finite(),LEVEL_UNLOCK_INTERVAL:S().finite(),SKILL_SLOTS_BY_LEVEL:B(S().int().nonnegative())}).passthrough(),qs=B(w().min(1,"Value is required")).superRefine((s,r)=>{const m=new Set;s.forEach((o,v)=>{m.has(o)&&r.addIssue({code:ge.custom,message:"Value must be unique",path:[v]}),m.add(o)})});function Z(s){return JSON.parse(JSON.stringify(s))}function Y(s){const r={};for(const m of s){const o=m.path.length?m.path.map(v=>`${v}`).join("."):"__root__";r[o]||(r[o]=[]),r[o].push(m.message)}return r}function Bs(s){const r=We.safeParse(s);return r.success?{success:!0,errors:{}}:{success:!1,errors:Y(r.error.issues)}}function Fs(s){const r=Rs.safeParse(s);return r.success?{success:!0,errors:{}}:{success:!1,errors:Y(r.error.issues)}}function Vs(s){const r=Ds.safeParse(s);return r.success?{success:!0,errors:{}}:{success:!1,errors:Y(r.error.issues)}}function Hs(s){const r=Ms.safeParse(s);return r.success?{success:!0,errors:{}}:{success:!1,errors:Y(r.error.issues)}}function Us(s){const r=As.safeParse(s);return r.success?{success:!0,errors:{}}:{success:!1,errors:Y(r.error.issues)}}function Gs(s){const r=$s.safeParse(s);return r.success?{success:!0,errors:{}}:{success:!1,errors:Y(r.error.issues)}}function Ys(s){const r=Ps.safeParse(s);return r.success?{success:!0,errors:{}}:{success:!1,errors:Y(r.error.issues)}}function Le(s,r){const m=qs.safeParse(s);if(m.success)return{success:!0,errors:{}};const o=Y(m.error.issues),v={};for(const[C,N]of Object.entries(o))v[`${r}.${C}`]=N;return{success:!1,errors:v}}function Q(s,r){const m=new Map,o=new Map;for(const v of Object.values(s)){const C=v.id??"";o.set(C,(o.get(C)??0)+1)}for(const[v,C]of Object.entries(s)){const N=r(C);if(C.id&&o.get(C.id)>1){const T={...N.errors},I="id";T[I]=[...T[I]??[],"ID must be unique"],m.set(v,{success:!1,errors:T})}else m.set(v,N)}return m}function P(s){const r=Object.keys(s);return r.length?r[0]:null}function xe(s,r){let m=s,o=1;const v=new Set(Object.values(r).map(C=>C.id));for(;v.has(m);)m=`${s}-${o++}`;return m}function he(s,r){let m=s,o=1;for(;Object.prototype.hasOwnProperty.call(r,m);)m=`${s}-${o++}`;return m}function je(){return{kind:"damage",valueType:"flat",amount:0,canMiss:!0,canCrit:!0}}function Ws(s){return{type:"skill",id:xe("new-skill",s),name:"New Skill",desc:"",element:"neutral",targeting:{side:"enemy",mode:"single"},effects:[je()],costs:{}}}function Ks(s){return{type:"item",id:xe("new-item",s),name:"New Item",desc:"",element:"neutral",targeting:{side:"enemy",mode:"single"},effects:[je()],costs:{},consumable:!0}}function Qs(s){return{id:xe("new-status",s),name:"New Status",desc:"",tags:[],stackRule:"ignore"}}function Xs(s){return{id:he("new-class",s.classes),maxHp:25,maxSta:10,maxMp:5,atk:5,def:5,skills:[],startItems:[]}}function Js(s){return{id:he("new-enemy",s),name:"New Enemy",color:16777215,base:{maxHp:30,maxSta:10,maxMp:5,atk:5,def:5},scale:{maxHp:4,maxSta:2,maxMp:1,atk:1,def:1},skills:[],items:[],tags:[]}}function Zs(s){return{id:he("new-npc",s),name:"New NPC",kind:"generic",dialogue:{lines:[]}}}function X({title:s,entries:r,selectedId:m,onSelect:o,onAdd:v,onRemove:C,validation:N,addLabel:T}){const I=E.useMemo(()=>Object.entries(r).filter(([,i])=>!!i).sort((i,y)=>{var h,b,A,L;const a=((h=i[1])==null?void 0:h.name)??((b=i[1])==null?void 0:b.id)??i[0],g=((A=y[1])==null?void 0:A.name)??((L=y[1])==null?void 0:L.id)??y[0];return a.localeCompare(g)}),[r]);return e.jsxs("div",{className:"card",style:{flex:"0 0 260px",display:"flex",flexDirection:"column",gap:8},children:[e.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{margin:0},children:s}),e.jsx("button",{type:"button",onClick:v,children:T})]}),e.jsx("div",{style:{overflowY:"auto",maxHeight:"60vh",border:"1px solid var(--border)",borderRadius:4},children:e.jsxs("ul",{style:{listStyle:"none",margin:0,padding:0},children:[I.map(([i,y])=>{const a=m===i,g=N.get(i),h=g?!g.success:!1;return e.jsx("li",{style:{borderBottom:"1px solid var(--border)",background:a?"rgba(80,120,255,0.1)":"transparent"},children:e.jsxs("div",{className:"row",style:{padding:"8px 12px",alignItems:"center",justifyContent:"space-between",gap:8},children:[e.jsxs("button",{type:"button",onClick:()=>o(i),style:{flex:1,textAlign:"left",background:"none",border:"none",padding:0,cursor:"pointer"},children:[e.jsx("div",{style:{fontWeight:600},children:(y==null?void 0:y.name)??(y==null?void 0:y.id)??i}),e.jsx("div",{className:"small",style:{color:"#666"},children:(y==null?void 0:y.id)??i})]}),h&&e.jsx("span",{title:"Has validation issues",style:{color:"#d22",fontWeight:700},children:"!"}),e.jsx("button",{type:"button",onClick:()=>C(i),"aria-label":`Remove ${(y==null?void 0:y.name)??i}`,children:"Ã—"})]})},i)}),I.length===0&&e.jsx("li",{style:{padding:12,color:"#666"},children:"No entries yet."})]})})]})}function x({error:s}){return!s||s.length===0?null:e.jsx("div",{role:"alert",className:"small",style:{color:"#d22"},children:s.join(", ")})}function ee({label:s,value:r,onChange:m,errors:o,description:v}){const[C,N]=E.useState(""),[T,I]=E.useState(null);E.useEffect(()=>{const a=r===void 0?"":JSON.stringify(r,null,2);N(a),I(null)},[r]);const i=a=>{if(N(a),a.trim()===""){I(null),m(void 0);return}try{const g=JSON.parse(a);I(null),m(g)}catch{I("Invalid JSON")}},y=[...o??[]];return T&&y.push(T),e.jsxs("label",{style:{display:"block"},children:[e.jsx("div",{children:s}),v&&e.jsx("div",{className:"small",style:{color:"#666",marginBottom:4},children:v}),e.jsx("textarea",{value:C,onChange:a=>i(a.target.value),rows:6,style:{width:"100%",fontFamily:"monospace"}}),e.jsx(x,{error:y.length?y:void 0})]})}function Ke({kind:s,title:r,skill:m,onChange:o,errors:v,extras:C}){var A,L,O,q,D,R,f,j;const N=t=>{o({...m,...t})},T=t=>{N({targeting:{...m.targeting,...t}})},I=t=>{const l={...m.costs??{}};for(const[d,_]of Object.entries(t))_==null?delete l[d]:l[d]=_;N({costs:Object.keys(l).length?l:void 0})},i=t=>l=>{const d=l===""?void 0:Number(l);I({[t]:d})},y=(t,l)=>{var F;const d=(F=m.costs)==null?void 0:F.item,_=t==="id"?l:(d==null?void 0:d.id)??"",p=t==="qty"?l===""?void 0:Number(l):d==null?void 0:d.qty,W=p!==void 0&&Number.isFinite(p)?p:void 0;if(!_||W===void 0){I({item:void 0});return}I({item:{id:_,qty:W}})},a=(t,l)=>{const d=m.effects.map((_,p)=>p===t?{..._,...l}:_);N({effects:d})},g=()=>N({effects:[...m.effects,je()]}),h=t=>{const l=m.effects.filter((d,_)=>_!==t);N({effects:l})},b=t=>v[t];return e.jsxs("div",{className:"card",style:{flex:1,display:"flex",flexDirection:"column",gap:16},children:[e.jsx("h3",{style:{margin:0},children:r}),e.jsx(x,{error:b("__root__")}),e.jsxs("div",{className:"grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:12},children:[e.jsxs("label",{children:[e.jsx("div",{children:"Skill ID"}),e.jsx("input",{"aria-label":"Skill ID",value:m.id,onChange:t=>N({id:t.target.value})}),e.jsx(x,{error:b("id")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Skill Name"}),e.jsx("input",{"aria-label":"Skill Name",value:m.name,onChange:t=>N({name:t.target.value})}),e.jsx(x,{error:b("name")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Element"}),e.jsx("input",{value:m.element??"",onChange:t=>N({element:t.target.value})})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Target Side"}),e.jsx("select",{"aria-label":"Target Side",value:m.targeting.side,onChange:t=>T({side:t.target.value}),children:$e.map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsx(x,{error:b("targeting.side")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Target Mode"}),e.jsx("select",{"aria-label":"Target Mode",value:m.targeting.mode,onChange:t=>T({mode:t.target.value}),children:Pe.map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsx(x,{error:b("targeting.mode")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Target Count"}),e.jsx("input",{type:"number",value:m.targeting.count??"",onChange:t=>T({count:t.target.value===""?void 0:Number(t.target.value)}),min:1})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Target Metric"}),e.jsxs("select",{value:m.targeting.ofWhat??"",onChange:t=>T({ofWhat:t.target.value===""?void 0:t.target.value}),children:[e.jsx("option",{value:"",children:"(none)"}),qe.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("label",{className:"row",style:{alignItems:"center",gap:6},children:[e.jsx("input",{type:"checkbox",checked:!!m.targeting.includeDead,onChange:t=>T({includeDead:t.target.checked})}),e.jsx("span",{children:"Include Dead Targets"})]})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Description"}),e.jsx("textarea",{value:m.desc??"",onChange:t=>N({desc:t.target.value}),rows:3})]}),C,e.jsxs("section",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsx("h4",{style:{margin:"8px 0 0"},children:"Costs"}),e.jsxs("div",{className:"grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:12},children:[e.jsxs("label",{children:[e.jsx("div",{children:"STA"}),e.jsx("input",{type:"number",value:((A=m.costs)==null?void 0:A.sta)??"",min:0,onChange:t=>i("sta")(t.target.value)})]}),e.jsxs("label",{children:[e.jsx("div",{children:"MP"}),e.jsx("input",{type:"number",value:((L=m.costs)==null?void 0:L.mp)??"",min:0,onChange:t=>i("mp")(t.target.value)})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Cooldown"}),e.jsx("input",{type:"number",value:((O=m.costs)==null?void 0:O.cooldown)??"",min:0,onChange:t=>i("cooldown")(t.target.value)})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Charges"}),e.jsx("input",{type:"number",value:((q=m.costs)==null?void 0:q.charges)??"",min:0,onChange:t=>i("charges")(t.target.value)})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Cost Item ID"}),e.jsx("input",{value:((R=(D=m.costs)==null?void 0:D.item)==null?void 0:R.id)??"",onChange:t=>y("id",t.target.value)}),e.jsx(x,{error:b("costs.item")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Cost Item Qty"}),e.jsx("input",{type:"number",min:1,value:((j=(f=m.costs)==null?void 0:f.item)==null?void 0:j.qty)??"",onChange:t=>y("qty",t.target.value)})]})]})]}),e.jsxs("section",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{margin:"8px 0 0"},children:"Effects"}),e.jsx("button",{type:"button",onClick:g,children:"Add Effect"})]}),m.effects.map((t,l)=>{var _;const d=`effects.${l}`;return e.jsxs("div",{className:"card",style:{borderColor:"#ddd",padding:12,display:"flex",flexDirection:"column",gap:8},children:[e.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("strong",{children:["Effect ",l+1]}),e.jsx("button",{type:"button",onClick:()=>h(l),"aria-label":`Remove effect ${l+1}`,children:"Remove"})]}),e.jsxs("div",{className:"grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:12},children:[e.jsxs("label",{children:[e.jsx("div",{children:"Kind"}),e.jsx("select",{value:t.kind,onChange:p=>a(l,{kind:p.target.value}),children:Be.map(p=>e.jsx("option",{value:p,children:p},p))}),e.jsx(x,{error:b(`${d}.kind`)})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Value Type"}),e.jsxs("select",{value:t.valueType??"",onChange:p=>a(l,{valueType:p.target.value===""?void 0:p.target.value}),children:[e.jsx("option",{value:"",children:"(auto)"}),Fe.map(p=>e.jsx("option",{value:p,children:p},p))]})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Amount"}),e.jsx("input",{"aria-label":`Effect ${l+1} Amount`,type:"number",value:t.amount??"",onChange:p=>a(l,{amount:p.target.value===""?void 0:Number(p.target.value)})}),e.jsx(x,{error:b(`${d}.amount`)})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Percent"}),e.jsx("input",{type:"number",value:t.percent??"",onChange:p=>a(l,{percent:p.target.value===""?void 0:Number(p.target.value)})})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Formula"}),e.jsx("input",{value:((_=t.formula)==null?void 0:_.expr)??"",onChange:p=>a(l,{formula:p.target.value?{expr:p.target.value}:void 0})}),e.jsx(x,{error:b(`${d}.formula`)})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Min"}),e.jsx("input",{type:"number",value:t.min??"",onChange:p=>a(l,{min:p.target.value===""?void 0:Number(p.target.value)})})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Max"}),e.jsx("input",{type:"number",value:t.max??"",onChange:p=>a(l,{max:p.target.value===""?void 0:Number(p.target.value)})})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Element"}),e.jsx("input",{value:t.element??"",onChange:p=>a(l,{element:p.target.value})})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Resource"}),e.jsxs("select",{value:t.resource??"",onChange:p=>a(l,{resource:p.target.value===""?void 0:p.target.value}),children:[e.jsx("option",{value:"",children:"(none)"}),Ve.map(p=>e.jsx("option",{value:p,children:p},p))]})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Stat"}),e.jsxs("select",{value:t.stat??"",onChange:p=>a(l,{stat:p.target.value===""?void 0:p.target.value}),children:[e.jsx("option",{value:"",children:"(none)"}),He.map(p=>e.jsx("option",{value:p,children:p},p))]})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Status ID"}),e.jsx("input",{value:t.statusId??"",onChange:p=>a(l,{statusId:p.target.value})})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Status Turns"}),e.jsx("input",{type:"number",value:t.statusTurns??"",onChange:p=>a(l,{statusTurns:p.target.value===""?void 0:Number(p.target.value)}),min:0})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Shield ID"}),e.jsx("input",{value:t.shieldId??"",onChange:p=>a(l,{shieldId:p.target.value})})]}),e.jsxs("label",{className:"row",style:{alignItems:"center",gap:6},children:[e.jsx("input",{type:"checkbox",checked:!!t.canMiss,onChange:p=>a(l,{canMiss:p.target.checked})}),e.jsx("span",{children:"Can Miss"})]}),e.jsxs("label",{className:"row",style:{alignItems:"center",gap:6},children:[e.jsx("input",{type:"checkbox",checked:!!t.canCrit,onChange:p=>a(l,{canCrit:p.target.checked})}),e.jsx("span",{children:"Can Crit"})]})]})]},l)}),e.jsx(x,{error:b("effects")})]})]})}function zs({item:s,onChange:r,errors:m}){const o=C=>{r({...s,...C,type:"item"})},v=e.jsxs("label",{className:"row",style:{alignItems:"center",gap:6},children:[e.jsx("input",{type:"checkbox",checked:!!s.consumable,onChange:C=>o({consumable:C.target.checked})}),e.jsx("span",{children:"Consumable"})]});return e.jsx(Ke,{kind:"item",title:"Item Details",skill:s,onChange:C=>o(C),errors:m,extras:v})}function et({clazz:s,onChange:r,errors:m}){const o=g=>{r({...s,...g})},v=g=>h=>{const b=Number(h);o({[g]:Number.isFinite(b)?b:0})},C=(g,h)=>{const b=s.skills.slice();b[g]=h,o({skills:b})},N=()=>{o({skills:[...s.skills,""]})},T=g=>{const h=s.skills.filter((b,A)=>A!==g);o({skills:h})},I=(g,h)=>{const b=s.startItems.map((A,L)=>L===g?{...A,...h}:A);o({startItems:b})},i=()=>{o({startItems:[...s.startItems,{id:"",qty:1}]})},y=g=>{o({startItems:s.startItems.filter((h,b)=>b!==g)})},a=g=>m[g];return e.jsxs("div",{className:"card",style:{flex:1,display:"flex",flexDirection:"column",gap:16},children:[e.jsx("h3",{style:{margin:0},children:"Class Details"}),e.jsx(x,{error:a("__root__")}),e.jsxs("div",{className:"grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:12},children:[e.jsxs("label",{children:[e.jsx("div",{children:"Class ID"}),e.jsx("input",{"aria-label":"Class ID",value:s.id,onChange:g=>o({id:g.target.value})}),e.jsx(x,{error:a("id")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Max HP"}),e.jsx("input",{type:"number","aria-label":"Max HP",value:s.maxHp,onChange:g=>v("maxHp")(g.target.value)}),e.jsx(x,{error:a("maxHp")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Max STA"}),e.jsx("input",{type:"number","aria-label":"Max STA",value:s.maxSta,onChange:g=>v("maxSta")(g.target.value)}),e.jsx(x,{error:a("maxSta")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Max MP"}),e.jsx("input",{type:"number","aria-label":"Max MP",value:s.maxMp,onChange:g=>v("maxMp")(g.target.value)}),e.jsx(x,{error:a("maxMp")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Attack"}),e.jsx("input",{type:"number","aria-label":"Attack",value:s.atk,onChange:g=>v("atk")(g.target.value)}),e.jsx(x,{error:a("atk")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Defense"}),e.jsx("input",{type:"number","aria-label":"Defense",value:s.def,onChange:g=>v("def")(g.target.value)}),e.jsx(x,{error:a("def")})]})]}),e.jsxs("section",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{margin:0},children:"Class Skills"}),e.jsx("button",{type:"button",onClick:N,children:"Add Skill"})]}),s.skills.length===0&&e.jsx("div",{style:{color:"#666"},children:"No class skills yet."}),s.skills.map((g,h)=>e.jsxs("div",{className:"row",style:{gap:12,alignItems:"flex-end"},children:[e.jsxs("label",{style:{flex:1},children:[e.jsx("div",{children:`Skill ${h+1}`}),e.jsx("input",{"aria-label":`Class Skill ${h+1}`,value:g,onChange:b=>C(h,b.target.value)}),e.jsx(x,{error:a(`skills.${h}`)})]}),e.jsx("button",{type:"button",onClick:()=>T(h),children:"Remove"})]},h))]}),e.jsxs("section",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{margin:0},children:"Starting Items"}),e.jsx("button",{type:"button",onClick:i,children:"Add Item"})]}),s.startItems.length===0&&e.jsx("div",{style:{color:"#666"},children:"No starting items yet."}),s.startItems.map((g,h)=>e.jsxs("div",{className:"row",style:{gap:12,alignItems:"flex-end"},children:[e.jsxs("label",{style:{flex:1},children:[e.jsx("div",{children:`Item ${h+1} ID`}),e.jsx("input",{"aria-label":`Start Item ${h+1} ID`,value:g.id,onChange:b=>I(h,{id:b.target.value})}),e.jsx(x,{error:a(`startItems.${h}.id`)})]}),e.jsxs("label",{children:[e.jsx("div",{children:`Item ${h+1} Quantity`}),e.jsx("input",{type:"number","aria-label":`Start Item ${h+1} Quantity`,value:g.qty,onChange:b=>I(h,{qty:Number(b.target.value)||0}),min:0}),e.jsx(x,{error:a(`startItems.${h}.qty`)})]}),e.jsx("button",{type:"button",onClick:()=>y(h),children:"Remove"})]},h))]})]})}function st({status:s,onChange:r,errors:m}){const o=i=>{r({...s,...i})},v=s.tags??[],C=(i,y)=>{const a=v.slice();a[i]=y,o({tags:a})},N=()=>o({tags:[...v,""]}),T=i=>o({tags:v.filter((y,a)=>a!==i)}),I=i=>m[i];return e.jsxs("div",{className:"card",style:{flex:1,display:"flex",flexDirection:"column",gap:16},children:[e.jsx("h3",{style:{margin:0},children:"Status Details"}),e.jsx(x,{error:I("__root__")}),e.jsxs("div",{className:"grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:12},children:[e.jsxs("label",{children:[e.jsx("div",{children:"Status ID"}),e.jsx("input",{"aria-label":"Status ID",value:s.id,onChange:i=>o({id:i.target.value})}),e.jsx(x,{error:I("id")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Status Name"}),e.jsx("input",{"aria-label":"Status Name",value:s.name,onChange:i=>o({name:i.target.value})}),e.jsx(x,{error:I("name")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Icon"}),e.jsx("input",{value:s.icon??"",onChange:i=>o({icon:i.target.value})})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Stack Rule"}),e.jsxs("select",{value:s.stackRule??"",onChange:i=>o({stackRule:i.target.value===""?void 0:i.target.value}),children:[e.jsx("option",{value:"",children:"(none)"}),Ue.map(i=>e.jsx("option",{value:i,children:i},i))]})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Max Stacks"}),e.jsx("input",{type:"number",value:s.maxStacks??"",min:1,onChange:i=>o({maxStacks:i.target.value===""?void 0:Number(i.target.value)||void 0})}),e.jsx(x,{error:I("maxStacks")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Duration (Turns)"}),e.jsx("input",{type:"number",value:s.durationTurns??"",min:0,onChange:i=>o({durationTurns:i.target.value===""?void 0:Number(i.target.value)||void 0})}),e.jsx(x,{error:I("durationTurns")})]})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Description"}),e.jsx("textarea",{value:s.desc??"",onChange:i=>o({desc:i.target.value}),rows:3})]}),e.jsxs("section",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{margin:0},children:"Tags"}),e.jsx("button",{type:"button",onClick:N,children:"Add Tag"})]}),v.length===0&&e.jsx("div",{style:{color:"#666"},children:"No tags yet."}),v.map((i,y)=>e.jsxs("div",{className:"row",style:{gap:12,alignItems:"flex-end"},children:[e.jsxs("label",{style:{flex:1},children:[e.jsx("div",{children:`Tag ${y+1}`}),e.jsx("input",{"aria-label":`Status Tag ${y+1}`,value:i,onChange:a=>C(y,a.target.value)}),e.jsx(x,{error:I(`tags.${y}`)})]}),e.jsx("button",{type:"button",onClick:()=>T(y),children:"Remove"})]},y))]}),e.jsx(ee,{label:"Modifiers",value:s.modifiers,onChange:i=>o({modifiers:i}),errors:I("modifiers"),description:"JSON object for stat adjustments, shields, and related metadata."}),e.jsx(ee,{label:"Hooks",value:s.hooks,onChange:i=>o({hooks:i}),errors:I("hooks"),description:"JSON object describing trigger effects (onTurnStart, onApply, etc.)."})]})}function tt({enemy:s,onChange:r,errors:m}){var f,j;const o=t=>{r({...s,...t})},v=(t,l)=>d=>{const _=Number(d),p={...s[t],[l]:Number.isFinite(_)?_:0};o({[t]:p})},C=s.skills??[],N=(t,l)=>{const d=C.slice();d[t]=l,o({skills:d})},T=()=>o({skills:[...C,""]}),I=t=>o({skills:C.filter((l,d)=>d!==t)}),i=s.items??[],y=(t,l)=>{const d=i.map((_,p)=>p===t?{..._,...l}:_);o({items:d})},a=()=>o({items:[...i,{id:"",qty:1}]}),g=t=>o({items:i.filter((l,d)=>d!==t)}),h=s.tags??[],b=(t,l)=>{const d=h.slice();d[t]=l,o({tags:d})},A=()=>o({tags:[...h,""]}),L=t=>o({tags:h.filter((l,d)=>d!==t)}),O=t=>{const l={...s.ai??{}};for(const[_,p]of Object.entries(t))Array.isArray(p)&&p.length===0||p===void 0?delete l[_]:l[_]=p;const d=Object.keys(l);o({ai:d.length===0?void 0:l})},q=((f=s.ai)==null?void 0:f.preferTags)??[],D=((j=s.ai)==null?void 0:j.avoidTags)??[],R=t=>m[t];return e.jsxs("div",{className:"card",style:{flex:1,display:"flex",flexDirection:"column",gap:16},children:[e.jsx("h3",{style:{margin:0},children:"Enemy Details"}),e.jsx(x,{error:R("__root__")}),e.jsxs("div",{className:"grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:12},children:[e.jsxs("label",{children:[e.jsx("div",{children:"Enemy ID"}),e.jsx("input",{"aria-label":"Enemy ID",value:s.id,onChange:t=>o({id:t.target.value})}),e.jsx(x,{error:R("id")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Enemy Name"}),e.jsx("input",{"aria-label":"Enemy Name",value:s.name,onChange:t=>o({name:t.target.value})}),e.jsx(x,{error:R("name")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Color"}),e.jsx("input",{type:"number","aria-label":"Enemy Color",value:s.color,onChange:t=>o({color:Number(t.target.value)||0})}),e.jsx(x,{error:R("color")})]})]}),e.jsxs("section",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:12},children:[e.jsx("h4",{style:{gridColumn:"1 / -1",marginBottom:0},children:"Base Stats"}),["maxHp","maxSta","maxMp","atk","def"].map(t=>e.jsxs("label",{children:[e.jsx("div",{children:t}),e.jsx("input",{type:"number",value:s.base[t],onChange:l=>v("base",t)(l.target.value)}),e.jsx(x,{error:R(`base.${t}`)})]},`base-${t}`))]}),e.jsxs("section",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:12},children:[e.jsx("h4",{style:{gridColumn:"1 / -1",marginBottom:0},children:"Scaling Per Level"}),["maxHp","maxSta","maxMp","atk","def"].map(t=>e.jsxs("label",{children:[e.jsx("div",{children:t}),e.jsx("input",{type:"number",value:s.scale[t],onChange:l=>v("scale",t)(l.target.value)}),e.jsx(x,{error:R(`scale.${t}`)})]},`scale-${t}`))]}),e.jsxs("section",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{margin:0},children:"Skills"}),e.jsx("button",{type:"button",onClick:T,children:"Add Skill"})]}),C.length===0&&e.jsx("div",{style:{color:"#666"},children:"No skills yet."}),C.map((t,l)=>e.jsxs("div",{className:"row",style:{gap:12,alignItems:"flex-end"},children:[e.jsxs("label",{style:{flex:1},children:[e.jsx("div",{children:`Skill ${l+1}`}),e.jsx("input",{"aria-label":`Enemy Skill ${l+1}`,value:t,onChange:d=>N(l,d.target.value)}),e.jsx(x,{error:R(`skills.${l}`)})]}),e.jsx("button",{type:"button",onClick:()=>I(l),children:"Remove"})]},l))]}),e.jsxs("section",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{margin:0},children:"Loot Table"}),e.jsx("button",{type:"button",onClick:a,children:"Add Drop"})]}),i.length===0&&e.jsx("div",{style:{color:"#666"},children:"No drops yet."}),i.map((t,l)=>e.jsxs("div",{className:"row",style:{gap:12,alignItems:"flex-end"},children:[e.jsxs("label",{style:{flex:1},children:[e.jsx("div",{children:`Drop ${l+1} ID`}),e.jsx("input",{"aria-label":`Enemy Drop ${l+1} ID`,value:t.id,onChange:d=>y(l,{id:d.target.value})}),e.jsx(x,{error:R(`items.${l}.id`)})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Quantity"}),e.jsx("input",{type:"number","aria-label":`Enemy Drop ${l+1} Quantity`,value:t.qty,onChange:d=>y(l,{qty:Number(d.target.value)||0}),min:0}),e.jsx(x,{error:R(`items.${l}.qty`)})]}),e.jsx("button",{type:"button",onClick:()=>g(l),children:"Remove"})]},l))]}),e.jsxs("section",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{margin:0},children:"Tags"}),e.jsx("button",{type:"button",onClick:A,children:"Add Tag"})]}),h.length===0&&e.jsx("div",{style:{color:"#666"},children:"No tags yet."}),h.map((t,l)=>e.jsxs("div",{className:"row",style:{gap:12,alignItems:"flex-end"},children:[e.jsxs("label",{style:{flex:1},children:[e.jsx("div",{children:`Tag ${l+1}`}),e.jsx("input",{value:t,onChange:d=>b(l,d.target.value)}),e.jsx(x,{error:R(`tags.${l}`)})]}),e.jsx("button",{type:"button",onClick:()=>L(l),children:"Remove"})]},l))]}),e.jsxs("section",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsx("h4",{style:{margin:0},children:"AI Preferences"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Prefer Tags"}),e.jsx("button",{type:"button",style:{marginLeft:8},onClick:()=>O({preferTags:[...q,""]}),children:"Add"})]}),q.length===0&&e.jsx("div",{style:{color:"#666"},children:"None"}),q.map((t,l)=>e.jsxs("div",{className:"row",style:{gap:12,alignItems:"flex-end"},children:[e.jsxs("label",{style:{flex:1},children:[e.jsx("div",{children:`Prefer Tag ${l+1}`}),e.jsx("input",{value:t,onChange:d=>O({preferTags:q.map((_,p)=>p===l?d.target.value:_)})}),e.jsx(x,{error:R(`ai.preferTags.${l}`)})]}),e.jsx("button",{type:"button",onClick:()=>O({preferTags:q.filter((d,_)=>_!==l)}),children:"Remove"})]},`prefer-${l}`))]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Avoid Tags"}),e.jsx("button",{type:"button",style:{marginLeft:8},onClick:()=>O({avoidTags:[...D,""]}),children:"Add"})]}),D.length===0&&e.jsx("div",{style:{color:"#666"},children:"None"}),D.map((t,l)=>e.jsxs("div",{className:"row",style:{gap:12,alignItems:"flex-end"},children:[e.jsxs("label",{style:{flex:1},children:[e.jsx("div",{children:`Avoid Tag ${l+1}`}),e.jsx("input",{value:t,onChange:d=>O({avoidTags:D.map((_,p)=>p===l?d.target.value:_)})}),e.jsx(x,{error:R(`ai.avoidTags.${l}`)})]}),e.jsx("button",{type:"button",onClick:()=>O({avoidTags:D.filter((d,_)=>_!==l)}),children:"Remove"})]},`avoid-${l}`))]})]})]})}function nt({npc:s,onChange:r,errors:m}){var O,q,D,R;const o=f=>{r({...s,...f})},v=f=>{const j={...s.wander??{}};for(const[l,d]of Object.entries(f))d===void 0||d===""?delete j[l]:j[l]=d;const t=Object.keys(j).length>0;o({wander:t?j:void 0})},C=f=>{const j={...s.trainer??{}};if(!f){o({trainer:void 0});return}for(const[l,d]of Object.entries(f))Array.isArray(d)?d.length===0?delete j[l]:j[l]=d:d&&typeof d=="object"?Object.keys(d).length===0?delete j[l]:j[l]=d:d===void 0||d===""?delete j[l]:j[l]=d;const t=Object.keys(j).length>0;o({trainer:t?j:void 0})},N=f=>{const j={...s.dialogue??{}};for(const[l,d]of Object.entries(f))Array.isArray(d)?d.length===0?delete j[l]:j[l]=d:d&&typeof d=="object"?Object.keys(d).length===0?delete j[l]:j[l]=d:d===void 0||d===""?delete j[l]:j[l]=d;const t=Object.keys(j).length>0;o({dialogue:t?j:void 0})},T=s.inventory??[],I=(f,j)=>{const t=T.map((l,d)=>d===f?{...l,...j}:l);o({inventory:t})},i=()=>o({inventory:[...T,{id:"",qty:1}]}),y=f=>o({inventory:T.filter((j,t)=>t!==f)}),a=s.trainer??{teaches:[]},g=a.teaches??[],h=Object.entries(a.priceBySkill??{}),b=f=>{const j={};f.forEach(([t,l])=>{j[t]=l}),C({priceBySkill:Object.keys(j).length?j:void 0})},A=((O=s.dialogue)==null?void 0:O.lines)??[],L=f=>m[f];return e.jsxs("div",{className:"card",style:{flex:1,display:"flex",flexDirection:"column",gap:16},children:[e.jsx("h3",{style:{margin:0},children:"NPC Details"}),e.jsx(x,{error:L("__root__")}),e.jsxs("div",{className:"grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:12},children:[e.jsxs("label",{children:[e.jsx("div",{children:"NPC ID"}),e.jsx("input",{"aria-label":"NPC ID",value:s.id,onChange:f=>o({id:f.target.value})}),e.jsx(x,{error:L("id")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"NPC Name"}),e.jsx("input",{"aria-label":"NPC Name",value:s.name,onChange:f=>o({name:f.target.value})}),e.jsx(x,{error:L("name")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Kind"}),e.jsx("select",{value:s.kind,onChange:f=>o({kind:f.target.value}),children:Ge.map(f=>e.jsx("option",{value:f,children:f},f))}),e.jsx(x,{error:L("kind")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Respawn Turns"}),e.jsx("input",{type:"number",value:s.respawnTurns??"",onChange:f=>o({respawnTurns:f.target.value===""?void 0:Number(f.target.value)||void 0}),min:0}),e.jsx(x,{error:L("respawnTurns")})]})]}),e.jsxs("div",{className:"grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:12},children:[e.jsxs("label",{children:[e.jsx("div",{children:"Wander Speed"}),e.jsx("input",{type:"number",value:((q=s.wander)==null?void 0:q.speed)??"",min:0,onChange:f=>v({speed:f.target.value===""?void 0:Number(f.target.value)||void 0})}),e.jsx(x,{error:L("wander.speed")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Wander Region"}),e.jsx("input",{value:((D=s.wander)==null?void 0:D.region)??"",onChange:f=>v({region:f.target.value})}),e.jsx(x,{error:L("wander.region")})]})]}),e.jsxs("section",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{margin:0},children:"Inventory"}),e.jsx("button",{type:"button",onClick:i,children:"Add Item"})]}),T.length===0&&e.jsx("div",{style:{color:"#666"},children:"No inventory items yet."}),T.map((f,j)=>e.jsxs("div",{className:"row",style:{gap:12,alignItems:"flex-end",flexWrap:"wrap"},children:[e.jsxs("label",{style:{flex:"1 1 160px"},children:[e.jsx("div",{children:`Item ${j+1} ID`}),e.jsx("input",{"aria-label":`NPC Item ${j+1} ID`,value:f.id??"",onChange:t=>I(j,{id:t.target.value})}),e.jsx(x,{error:L(`inventory.${j}.id`)})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Quantity"}),e.jsx("input",{type:"number","aria-label":`NPC Item ${j+1} Quantity`,value:f.qty??0,onChange:t=>I(j,{qty:Number(t.target.value)||0}),min:0}),e.jsx(x,{error:L(`inventory.${j}.qty`)})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Price"}),e.jsx("input",{type:"number",value:f.price??"",onChange:t=>I(j,{price:t.target.value===""?void 0:Number(t.target.value)}),min:0}),e.jsx(x,{error:L(`inventory.${j}.price`)})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Rarity"}),e.jsxs("select",{value:f.rarity??"",onChange:t=>{const l=t.target.value;I(j,{rarity:l===""?void 0:l})},children:[e.jsx("option",{value:"",children:"None"}),_s.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsx(x,{error:L(`inventory.${j}.rarity`)})]}),e.jsx("button",{type:"button",onClick:()=>y(j),children:"Remove"})]},j))]}),e.jsxs("section",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsx("h4",{style:{margin:0},children:"Trainer"}),e.jsxs("label",{children:[e.jsx("div",{children:"Trainer Class"}),e.jsx("input",{value:a.clazz??"",onChange:f=>C({clazz:f.target.value})})]}),e.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h5",{style:{margin:0},children:"Teaches Skills"}),e.jsx("button",{type:"button",onClick:()=>C({teaches:[...g,""]}),children:"Add Skill"})]}),g.length===0&&e.jsx("div",{style:{color:"#666"},children:"No skills taught yet."}),g.map((f,j)=>e.jsxs("div",{className:"row",style:{gap:12,alignItems:"flex-end"},children:[e.jsxs("label",{style:{flex:1},children:[e.jsx("div",{children:`Skill ${j+1}`}),e.jsx("input",{"aria-label":`Trainer Skill ${j+1}`,value:f,onChange:t=>C({teaches:g.map((l,d)=>d===j?t.target.value:l)})}),e.jsx(x,{error:L(`trainer.teaches.${j}`)})]}),e.jsx("button",{type:"button",onClick:()=>C({teaches:g.filter((t,l)=>l!==j)}),children:"Remove"})]},j)),e.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h5",{style:{margin:0},children:"Skill Prices"}),e.jsx("button",{type:"button",onClick:()=>b([...h,["",0]]),children:"Add Price"})]}),h.length===0&&e.jsx("div",{style:{color:"#666"},children:"No price overrides."}),h.map(([f,j],t)=>e.jsxs("div",{className:"row",style:{gap:12,alignItems:"flex-end"},children:[e.jsxs("label",{style:{flex:1},children:[e.jsx("div",{children:`Skill ${t+1} ID`}),e.jsx("input",{"aria-label":`Trainer Price ${t+1} Skill`,value:f,onChange:l=>{const d=h.slice();d[t]=[l.target.value,j],b(d)}}),e.jsx(x,{error:L(`trainer.priceBySkill.${f||""}`)})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Price"}),e.jsx("input",{type:"number","aria-label":`Trainer Price ${t+1} Amount`,value:j,onChange:l=>{const d=h.slice();d[t]=[f,Number(l.target.value)||0],b(d)},min:0})]}),e.jsx("button",{type:"button",onClick:()=>b(h.filter((l,d)=>d!==t)),children:"Remove"})]},t))]}),e.jsxs("section",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{margin:0},children:"Dialogue Lines"}),e.jsx("button",{type:"button",onClick:()=>N({lines:[...A,""]}),children:"Add Line"})]}),A.length===0&&e.jsx("div",{style:{color:"#666"},children:"No dialogue lines yet."}),A.map((f,j)=>e.jsxs("div",{className:"row",style:{gap:12,alignItems:"flex-end"},children:[e.jsxs("label",{style:{flex:1},children:[e.jsx("div",{children:`Line ${j+1}`}),e.jsx("input",{"aria-label":`Dialogue Line ${j+1}`,value:f,onChange:t=>N({lines:A.map((l,d)=>d===j?t.target.value:l)})}),e.jsx(x,{error:L(`dialogue.lines.${j}`)})]}),e.jsx("button",{type:"button",onClick:()=>N({lines:A.filter((t,l)=>l!==j)}),children:"Remove"})]},j)),e.jsx(ee,{label:"Dialogue Options",value:(R=s.dialogue)==null?void 0:R.options,onChange:f=>N({options:f}),errors:L("dialogue.options"),description:"Optional interactive options with text and action arrays."})]})]})}function lt({balance:s,onChange:r,errors:m}){const o=a=>{r({...s,...a})},v=a=>g=>{const h=Number(g);o({[a]:Number.isFinite(h)?h:0})},C=a=>{o({ECONOMY:{...s.ECONOMY,...a}})},N=(a,g)=>{const h=Number(g);C({priceByRarity:{...s.ECONOMY.priceByRarity,[a]:Number.isFinite(h)?h:0}})},T=a=>{o({XP_CURVE:{...s.XP_CURVE,...a}})},I=a=>{o({GOLD_DROP:{...s.GOLD_DROP,...a}})},i=a=>m[a],y=s.SKILL_SLOTS_BY_LEVEL.join(", ");return e.jsxs("div",{className:"card",style:{flex:1,display:"flex",flexDirection:"column",gap:16},children:[e.jsx("h3",{style:{margin:0},children:"Balance Settings"}),e.jsx(x,{error:i("__root__")}),e.jsxs("section",{className:"grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:12},children:[e.jsxs("label",{children:[e.jsx("div",{children:"Base Hit Chance"}),e.jsx("input",{type:"number",value:s.BASE_HIT,step:"0.01",onChange:a=>v("BASE_HIT")(a.target.value)}),e.jsx(x,{error:i("BASE_HIT")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Base Crit Chance"}),e.jsx("input",{type:"number",value:s.BASE_CRIT,step:"0.01",onChange:a=>v("BASE_CRIT")(a.target.value)}),e.jsx(x,{error:i("BASE_CRIT")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Crit Multiplier"}),e.jsx("input",{type:"number",value:s.CRIT_MULT,step:"0.01",onChange:a=>v("CRIT_MULT")(a.target.value)}),e.jsx(x,{error:i("CRIT_MULT")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Dodge Floor"}),e.jsx("input",{type:"number",value:s.DODGE_FLOOR,step:"0.01",onChange:a=>v("DODGE_FLOOR")(a.target.value)}),e.jsx(x,{error:i("DODGE_FLOOR")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Hit Ceiling"}),e.jsx("input",{type:"number",value:s.HIT_CEIL,step:"0.01",onChange:a=>v("HIT_CEIL")(a.target.value)}),e.jsx(x,{error:i("HIT_CEIL")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Flee Base Chance"}),e.jsx("input",{type:"number",value:s.FLEE_BASE,step:"0.01",onChange:a=>v("FLEE_BASE")(a.target.value)}),e.jsx(x,{error:i("FLEE_BASE")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Loot Rolls"}),e.jsx("input",{type:"number",value:s.LOOT_ROLLS,onChange:a=>v("LOOT_ROLLS")(a.target.value)}),e.jsx(x,{error:i("LOOT_ROLLS")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Level Unlock Interval"}),e.jsx("input",{type:"number",value:s.LEVEL_UNLOCK_INTERVAL,onChange:a=>v("LEVEL_UNLOCK_INTERVAL")(a.target.value)}),e.jsx(x,{error:i("LEVEL_UNLOCK_INTERVAL")})]})]}),e.jsxs("section",{className:"grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:12},children:[e.jsx("h4",{style:{gridColumn:"1 / -1",marginBottom:0},children:"Economy"}),e.jsxs("label",{children:[e.jsx("div",{children:"Buy Multiplier"}),e.jsx("input",{type:"number",value:s.ECONOMY.buyMult,step:"0.01",onChange:a=>C({buyMult:Number(a.target.value)||0})}),e.jsx(x,{error:i("ECONOMY.buyMult")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Sell Multiplier"}),e.jsx("input",{type:"number",value:s.ECONOMY.sellMult,step:"0.01",onChange:a=>C({sellMult:Number(a.target.value)||0})}),e.jsx(x,{error:i("ECONOMY.sellMult")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Restock Turns"}),e.jsx("input",{type:"number",value:s.ECONOMY.restockTurns,onChange:a=>C({restockTurns:Number(a.target.value)||0})}),e.jsx(x,{error:i("ECONOMY.restockTurns")})]}),Object.entries(s.ECONOMY.priceByRarity).map(([a,g])=>e.jsxs("label",{children:[e.jsx("div",{children:`Price (${a})`}),e.jsx("input",{type:"number",value:g,onChange:h=>N(a,h.target.value)}),e.jsx(x,{error:i(`ECONOMY.priceByRarity.${a}`)})]},a))]}),e.jsxs("section",{className:"grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:12},children:[e.jsx("h4",{style:{gridColumn:"1 / -1",marginBottom:0},children:"Progression"}),e.jsxs("label",{children:[e.jsx("div",{children:"XP Base"}),e.jsx("input",{type:"number",value:s.XP_CURVE.base,onChange:a=>T({base:Number(a.target.value)||0})}),e.jsx(x,{error:i("XP_CURVE.base")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"XP Growth"}),e.jsx("input",{type:"number",value:s.XP_CURVE.growth,onChange:a=>T({growth:Number(a.target.value)||0})}),e.jsx(x,{error:i("XP_CURVE.growth")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Gold Mean"}),e.jsx("input",{type:"number",value:s.GOLD_DROP.mean,onChange:a=>I({mean:Number(a.target.value)||0})}),e.jsx(x,{error:i("GOLD_DROP.mean")})]}),e.jsxs("label",{children:[e.jsx("div",{children:"Gold Variance"}),e.jsx("input",{type:"number",value:s.GOLD_DROP.variance,onChange:a=>I({variance:Number(a.target.value)||0})}),e.jsx(x,{error:i("GOLD_DROP.variance")})]}),e.jsxs("label",{style:{gridColumn:"1 / -1"},children:[e.jsx("div",{children:"Skill Slots By Level"}),e.jsx("input",{value:y,onChange:a=>{const g=a.target.value.split(",").map(h=>Number(h.trim())).filter(h=>Number.isFinite(h));o({SKILL_SLOTS_BY_LEVEL:g})}}),e.jsx(x,{error:i("SKILL_SLOTS_BY_LEVEL")})]})]}),e.jsx(ee,{label:"Element Matrix",value:s.ELEMENT_MATRIX,onChange:a=>o({ELEMENT_MATRIX:a}),errors:i("ELEMENT_MATRIX"),description:"Nested record of attacker elements vs defender elements."}),e.jsx(ee,{label:"Resists By Tag",value:s.RESISTS_BY_TAG,onChange:a=>o({RESISTS_BY_TAG:a}),errors:i("RESISTS_BY_TAG"),description:"Record mapping enemy tags to damage resistance multipliers."})]})}function at({elements:s,tags:r,onChangeElements:m,onChangeTags:o,elementErrors:v,tagErrors:C}){const N=(y,a,g,h)=>{const b=y.slice();b[a]=g,h(b)},T=(y,a)=>a([...y,""]),I=(y,a,g)=>g(y.filter((h,b)=>b!==a)),i=(y,a,g,h,b,A)=>e.jsxs("section",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{margin:0},children:y}),e.jsxs("button",{type:"button",onClick:()=>T(g,h),children:["Add ",a]})]}),g.length===0&&e.jsxs("div",{style:{color:"#666"},children:["No ",a.toLowerCase(),"s yet."]}),g.map((L,O)=>e.jsxs("div",{className:"row",style:{gap:12,alignItems:"flex-end"},children:[e.jsxs("label",{style:{flex:1},children:[e.jsx("div",{children:`${a} ${O+1}`}),e.jsx("input",{"aria-label":`${y} ${O+1}`,value:L,onChange:q=>N(g,O,q.target.value,h)}),e.jsx(x,{error:b[`${A}.${O}`]})]}),e.jsx("button",{type:"button",onClick:()=>I(g,O,h),children:"Remove"})]},`${y}-${O}`))]},y);return e.jsxs("div",{className:"card",style:{flex:1,display:"flex",flexDirection:"column",gap:16},children:[i("Elements","Element",s,m,v,"elements"),i("Tags","Tag",r,o,C,"tags")]})}function rt(){var ke,Ne,Ee,Te,we,_e;const[s,r]=E.useState(()=>Z(ks())),[m,o]=E.useState(()=>P(s.skills)),[v,C]=E.useState(()=>P(s.items)),[N,T]=E.useState(()=>P(s.classes)),[I,i]=E.useState(()=>P(s.statuses)),[y,a]=E.useState(()=>P(s.enemies)),[g,h]=E.useState(()=>P(s.npcs)),[b,A]=E.useState("skills"),[L,O]=E.useState(null),[q,D]=E.useState("info"),[R,f]=E.useState(!0),[j,t]=E.useState(!1),[l,d]=E.useState(null),[_,p]=E.useState(!1),W=E.useCallback(async(n=!1)=>{f(!0),d(null);try{const c=await De({force:n});return r(Z(c)),t(!0),{ok:!0}}catch(c){const u=c instanceof Error?c.message:"Failed to load configuration.";return d(u),O(`Failed to load configuration: ${u}`),D("error"),{ok:!1,message:u}}finally{f(!1)}},[]);E.useEffect(()=>Me(c=>{r(Z(c)),t(!0)}),[]),E.useEffect(()=>{W(!1)},[W]);const F=E.useMemo(()=>{const n={};for(const[c,u]of Object.entries(s.classes))n[c]={id:c,maxHp:u.maxHp,maxSta:u.maxSta,maxMp:u.maxMp,atk:u.atk,def:u.def,skills:(s.classSkills[c]??[]).slice(),startItems:(s.startItems[c]??[]).map(k=>({...k}))};return n},[s.classes,s.classSkills,s.startItems]),G=E.useMemo(()=>{const n={};for(const[c,u]of Object.entries(s.enemies))n[c]={id:c,...u};return n},[s.enemies]);E.useEffect(()=>{m!==null&&s.skills[m]||o(n=>n!==null&&s.skills[n]?n:P(s.skills))},[s.skills,m]),E.useEffect(()=>{v!==null&&s.items[v]||C(n=>n!==null&&s.items[n]?n:P(s.items))},[s.items,v]),E.useEffect(()=>{N!==null&&F[N]||T(n=>n!==null&&F[n]?n:P(F))},[F,N]),E.useEffect(()=>{I!==null&&s.statuses[I]||i(n=>n!==null&&s.statuses[n]?n:P(s.statuses))},[s.statuses,I]),E.useEffect(()=>{y!==null&&G[y]||a(n=>n!==null&&G[n]?n:P(G))},[G,y]),E.useEffect(()=>{g!==null&&s.npcs[g]||h(n=>n!==null&&s.npcs[n]?n:P(s.npcs))},[s.npcs,g]);const se=E.useMemo(()=>Q(s.skills,Bs),[s.skills]),te=E.useMemo(()=>Q(s.items,Fs),[s.items]),ne=E.useMemo(()=>Q(F,Hs),[F]),le=E.useMemo(()=>Q(s.statuses,Vs),[s.statuses]),ae=E.useMemo(()=>Q(G,Us),[G]),re=E.useMemo(()=>Q(s.npcs,Gs),[s.npcs]),ce=E.useMemo(()=>Ys(s.balance),[s.balance]),de=E.useMemo(()=>Le(s.elements,"elements"),[s.elements]),ue=E.useMemo(()=>Le(s.tags??[],"tags"),[s.tags]),ve=E.useMemo(()=>{const n=[se,te,le,ne,ae,re];for(const c of n)for(const u of c.values())if(!u.success)return!0;return!ce.success||!de.success||!ue.success},[se,te,le,ne,ae,re,ce,de,ue]),Qe=ve||R||_,Xe=(n,c)=>{r(u=>{const k={...u.skills};delete k[n];const $=c.id;return k[$]={...c,type:"skill"},o($),{...u,skills:k}})},Je=(n,c)=>{r(u=>{const k={...u.items};delete k[n];const $=c.id;return k[$]={...c,type:"item"},C($),{...u,items:k}})},Ze=(n,c)=>{r(u=>{const k={...u.classes},$={...u.classSkills},V={...u.startItems};delete k[n],delete $[n],delete V[n];const{id:K,skills:me,startItems:pe,...Is}=c;return k[K]=Is,$[K]=me.map(ie=>ie.trim()),V[K]=pe.map(ie=>({id:ie.id,qty:ie.qty})),T(K),{...u,classes:k,classSkills:$,startItems:V}})},ze=(n,c)=>{r(u=>{const k={...u.statuses};return delete k[n],k[c.id]={...c},i(c.id),{...u,statuses:k}})},es=(n,c)=>{r(u=>{const k={...u.enemies};delete k[n];const{id:$,...V}=c;return k[$]={...V},a($),{...u,enemies:k}})},ss=(n,c)=>{r(u=>{const k={...u.npcs};return delete k[n],k[c.id]={...c},h(c.id),{...u,npcs:k}})},ts=n=>{r(c=>({...c,balance:n}))},ns=n=>{r(c=>({...c,elements:n}))},ls=n=>{r(c=>({...c,tags:n}))},as=()=>{r(n=>{const c=Ws(n.skills),u={...n.skills,[c.id]:c};return o(c.id),{...n,skills:u}})},rs=()=>{r(n=>{const c=Ks(n.items),u={...n.items,[c.id]:c};return C(c.id),{...n,items:u}})},is=()=>{r(n=>{const c=Xs(n),{id:u,skills:k,startItems:$,...V}=c,K={...n.classes,[u]:V},me={...n.classSkills,[u]:k},pe={...n.startItems,[u]:$};return T(u),{...n,classes:K,classSkills:me,startItems:pe}})},os=()=>{r(n=>{const c=Qs(n.statuses),u={...n.statuses,[c.id]:c};return i(c.id),{...n,statuses:u}})},cs=()=>{r(n=>{const c=Js(n.enemies),{id:u,...k}=c,$={...n.enemies,[u]:k};return a(u),{...n,enemies:$}})},ds=()=>{r(n=>{const c=Zs(n.npcs),u={...n.npcs,[c.id]:c};return h(c.id),{...n,npcs:u}})},us=n=>{r(c=>{const u={...c.skills};return delete u[n],o(k=>k!==n?k:P(u)),{...c,skills:u}})},ms=n=>{r(c=>{const u={...c.items};return delete u[n],C(k=>k!==n?k:P(u)),{...c,items:u}})},ps=n=>{r(c=>{const u={...c.classes},k={...c.classSkills},$={...c.startItems};return delete u[n],delete k[n],delete $[n],T(V=>V!==n?V:P(u)),{...c,classes:u,classSkills:k,startItems:$}})},gs=n=>{r(c=>{const u={...c.statuses};return delete u[n],i(k=>k!==n?k:P(u)),{...c,statuses:u}})},xs=n=>{r(c=>{const u={...c.enemies};return delete u[n],a(k=>k!==n?k:P(u)),{...c,enemies:u}})},hs=n=>{r(c=>{const u={...c.npcs};return delete u[n],h(k=>k!==n?k:P(u)),{...c,npcs:u}})},js=async()=>{p(!0),O("Saving configuration..."),D("info");try{const n=await Ns(s);r(Z(n)),O("Configuration saved."),D("success")}catch(n){const c=n instanceof Error?n.message:"Unable to save configuration.";O(`Unable to save configuration: ${c}`),D("error")}finally{p(!1)}},vs=async()=>{try{const n=await Es(),c=new Blob([n],{type:"application/json"}),u=document.createElement("a");u.href=URL.createObjectURL(c),u.download="game-config.json",u.click(),O("Configuration exported."),D("success")}catch(n){const c=n instanceof Error?n.message:"Unable to export configuration.";O(`Unable to export configuration: ${c}`),D("error")}},ys=async n=>{if(n)try{const c=await n.text(),u=await Ts(c);r(Z(u)),O("Configuration imported."),D("success")}catch(c){const u=c instanceof Error?c.message:"Unable to import configuration.";O(`Unable to import configuration: ${u}`),D("error")}},fs=async()=>{O("Reloading configuration..."),D("info");const n=await W(!0);n.ok?(O("Reloaded from server."),D("success")):(O(`Failed to reload configuration: ${n.message}`),D("error"))},ye=m!==null?s.skills[m]:null,fe=v!==null?s.items[v]:null,be=N!==null?F[N]:null,Ce=I!==null?s.statuses[I]:null,Se=y!==null?G[y]:null,Ie=g!==null?s.npcs[g]:null,bs=s.tags??[];if(!j)return R?e.jsxs("div",{style:{maxWidth:600,margin:"48px auto",padding:24},children:[e.jsx("h1",{children:"Loading configurationâ€¦"}),e.jsx("p",{className:"small",children:"Fetching the latest game data from the server."})]}):e.jsxs("div",{style:{maxWidth:600,margin:"48px auto",padding:24,display:"flex",flexDirection:"column",gap:16},children:[e.jsx("h1",{children:"Unable to load configuration"}),e.jsx("p",{className:"small",children:l??"An unexpected error occurred while loading the configuration."}),e.jsx("button",{type:"button",onClick:()=>void W(!0),children:"Retry"})]});const Cs=[{key:"skills",label:"Skills"},{key:"items",label:"Items"},{key:"classes",label:"Classes"},{key:"statuses",label:"Statuses"},{key:"enemies",label:"Enemies"},{key:"npcs",label:"NPCs"},{key:"balance",label:"Balance"},{key:"world",label:"World Data"}],Ss=q==="success"?{borderColor:"#4a8",color:"#1b4"}:q==="error"?{borderColor:"#e66",color:"#a11"}:{borderColor:"#48a",color:"#237"};let H;return b==="skills"?H=e.jsxs("div",{className:"row",style:{gap:16,alignItems:"flex-start"},children:[e.jsx(X,{title:"Skills",entries:s.skills,selectedId:m,onSelect:o,onAdd:as,onRemove:us,validation:se,addLabel:"Add Skill"}),ye?e.jsx(Ke,{kind:"skill",title:"Skill Details",skill:ye,onChange:n=>Xe(m??n.id,n),errors:((ke=se.get(m??""))==null?void 0:ke.errors)??{}}):e.jsx("div",{style:{padding:24,color:"#666"},children:"Select a skill to edit."})]}):b==="items"?H=e.jsxs("div",{className:"row",style:{gap:16,alignItems:"flex-start"},children:[e.jsx(X,{title:"Items",entries:s.items,selectedId:v,onSelect:C,onAdd:rs,onRemove:ms,validation:te,addLabel:"Add Item"}),fe?e.jsx(zs,{item:fe,onChange:n=>Je(v??n.id,n),errors:((Ne=te.get(v??""))==null?void 0:Ne.errors)??{}}):e.jsx("div",{style:{padding:24,color:"#666"},children:"Select an item to edit."})]}):b==="classes"?H=e.jsxs("div",{className:"row",style:{gap:16,alignItems:"flex-start"},children:[e.jsx(X,{title:"Classes",entries:F,selectedId:N,onSelect:T,onAdd:is,onRemove:ps,validation:ne,addLabel:"Add Class"}),be?e.jsx(et,{clazz:be,onChange:n=>Ze(N??n.id,n),errors:((Ee=ne.get(N??""))==null?void 0:Ee.errors)??{}}):e.jsx("div",{style:{padding:24,color:"#666"},children:"Select a class to edit."})]}):b==="statuses"?H=e.jsxs("div",{className:"row",style:{gap:16,alignItems:"flex-start"},children:[e.jsx(X,{title:"Statuses",entries:s.statuses,selectedId:I,onSelect:i,onAdd:os,onRemove:gs,validation:le,addLabel:"Add Status"}),Ce?e.jsx(st,{status:Ce,onChange:n=>ze(I??n.id,n),errors:((Te=le.get(I??""))==null?void 0:Te.errors)??{}}):e.jsx("div",{style:{padding:24,color:"#666"},children:"Select a status to edit."})]}):b==="enemies"?H=e.jsxs("div",{className:"row",style:{gap:16,alignItems:"flex-start"},children:[e.jsx(X,{title:"Enemies",entries:G,selectedId:y,onSelect:a,onAdd:cs,onRemove:xs,validation:ae,addLabel:"Add Enemy"}),Se?e.jsx(tt,{enemy:Se,onChange:n=>es(y??n.id,n),errors:((we=ae.get(y??""))==null?void 0:we.errors)??{}}):e.jsx("div",{style:{padding:24,color:"#666"},children:"Select an enemy to edit."})]}):b==="npcs"?H=e.jsxs("div",{className:"row",style:{gap:16,alignItems:"flex-start"},children:[e.jsx(X,{title:"NPCs",entries:s.npcs,selectedId:g,onSelect:h,onAdd:ds,onRemove:hs,validation:re,addLabel:"Add NPC"}),Ie?e.jsx(nt,{npc:Ie,onChange:n=>ss(g??n.id,n),errors:((_e=re.get(g??""))==null?void 0:_e.errors)??{}}):e.jsx("div",{style:{padding:24,color:"#666"},children:"Select an NPC to edit."})]}):b==="balance"?H=e.jsx("div",{className:"row",style:{gap:16,alignItems:"flex-start"},children:e.jsx(lt,{balance:s.balance,onChange:ts,errors:ce.errors})}):H=e.jsx("div",{className:"row",style:{gap:16,alignItems:"flex-start"},children:e.jsx(at,{elements:s.elements,tags:bs,onChangeElements:ns,onChangeTags:ls,elementErrors:de.errors,tagErrors:ue.errors})}),e.jsxs("div",{style:{maxWidth:1200,margin:"24px auto",padding:16,display:"flex",flexDirection:"column",gap:16},children:[e.jsx("h1",{children:"MinMMO Admin CMS"}),e.jsx("p",{className:"small",children:"All gameplay content is editable here. Changes apply after saving."}),e.jsxs("div",{className:"row",style:{gap:8,flexWrap:"wrap"},children:[e.jsx("button",{type:"button",onClick:()=>void js(),disabled:Qe,children:"Save"}),e.jsx("button",{type:"button",onClick:()=>void vs(),disabled:R,children:"Export JSON"}),e.jsxs("label",{className:"row",style:{gap:6,alignItems:"center"},children:[e.jsx("input",{type:"file",accept:"application/json",disabled:R,onChange:n=>{var c;return void ys(((c=n.target.files)==null?void 0:c[0])??void 0)}}),e.jsx("span",{className:"small",children:"Import JSON"})]}),e.jsx("button",{type:"button",onClick:()=>void fs(),disabled:R,children:"Reload"}),e.jsx("div",{className:"row",style:{marginLeft:"auto",gap:8,flexWrap:"wrap"},children:Cs.map(n=>e.jsx("button",{type:"button",onClick:()=>A(n.key),style:{fontWeight:b===n.key?700:400},children:n.label},n.key))})]}),L&&e.jsx("div",{className:"card",style:{...Ss,padding:12},children:L}),ve&&e.jsx("div",{className:"card",style:{borderColor:"#d22",color:"#d22",padding:12},children:"Resolve validation errors before saving."}),H]})}Me(Ae);De().then(Ae).catch(s=>{console.error("Failed to load configuration",s)});ws.createRoot(document.getElementById("root")).render(e.jsx(rt,{}));
